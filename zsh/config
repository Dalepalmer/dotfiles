# setenv() { export $1=$2 }

# * Lion
#
# Remember working directory.
precmd () { print -Pn "\e]7;file://%M${PWD// /%%20}\a" }

# * Git prompt
typeset -ga preexec_functions
typeset -ga precmd_functions
typeset -ga chpwd_functions
preexec_functions+='preexec_update_git_vars'
precmd_functions+='precmd_update_git_vars'
chpwd_functions+='chpwd_update_git_vars'

# * Colors
autoload -U colors
colors
setopt PROMPT_SUBST

if $(grc &>/dev/null)
then
  source `brew --prefix`/etc/grc.bashrc
fi

# * Prompts
export PROMPT=$'%2~ %{$bold_color%}$(prompt_git_info)%{${reset_color}%}%% '

if [[ -x ~/.rbenv/bin/rbenv ]] || [[ -x /usr/local/bin/rbenv ]]
then
  export RPROMPT=$'%{${fg[white]}%}$(rbenv version-name)%{${reset_color}%}'
fi

# * Load functions
fpath=(~/.zsh/functions $fpath)
autoload -U ~/.zsh/functions/*(:t)

HISTFILE=~/.histfile
HISTSIZE=1000
SAVEHIST=1000

setopt EXTENDED_HISTORY
setopt APPEND_HISTORY
setopt INC_APPEND_HISTORY SHARE_HISTORY
setopt HIST_IGNORE_ALL_DUPS
setopt HIST_REDUCE_BLANKS

setopt AUTO_CD
setopt COMPLETE_IN_WORD
setopt EXTENDED_GLOB
setopt LOCAL_OPTIONS
setopt LOCAL_TRAPS
setopt MULTIOS
setopt NO_BG_NICE
setopt NO_LIST_BEEP
setopt NO_MATCH
setopt NOTIFY

unsetopt NO_HUP

# * Emacs bindings
bindkey -e
bindkey '[D' backward-word
bindkey '[C' forward-word

[[ -x `which hub` ]] && function git { hub $@ }
